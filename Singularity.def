Bootstrap: docker
From: continuumio/miniconda3

%files
./markovmodels/* /markovmodels/
./markovmodels/protocols/* /markovmodels/protocols
setup.py setup.py
README.md README.md
MANIFEST.in MANIFEST.in
scripts scripts
environment.yml environment.yml

%post
    echo ". /opt/conda/etc/profile.d/conda.sh" >> ~/.bashrc
    . /opt/conda/etc/profile.d/conda.sh
    conda env create -f environment.yml
    conda activate markovmodels \
    && apt-get update \
    && apt-get install -y gcc g++ gfortran libgraphviz-dev \
    && pip install -e .

%runscript
    . /opt/conda/etc/profile.d/conda.sh
    conda activate markovmodels
    conda run -n markovmodels --no-capture-output "$@"
